'use client';

import { useState } from 'react';

export default function ChartMethod() {
  const [selectedSection, setSelectedSection] = useState('basic');

  const sections = [
    {
      id: 'basic',
      title: '排盘基础',
      icon: '🎯',
      description: '排盘的基本步骤和要素'
    },
    {
      id: 'time-setup',
      title: '时间起局',
      icon: '⏰',
      description: '年月日时的确定与转换'
    },
    {
      id: 'yin-yang',
      title: '阴阳遁局',
      icon: '☯️',
      description: '冬至夏至与阴阳二遁'
    },
    {
      id: 'palace-arrangement',
      title: '九宫排布',
      icon: '🏛️',
      description: '九星八门三奇的排列'
    },
    {
      id: 'complete-process',
      title: '完整流程',
      icon: '📋',
      description: '从时间到成局的完整步骤'
    }
  ];

  const content = {
    basic: {
      title: '排盘基础 - 奇门遁甲的操作核心',
      content: [
        {
          subtitle: '排盘的概念与意义',
          text: '排盘是奇门遁甲预测的核心操作过程，通过将天干地支、九星、八门、八神等符号按照特定规律排入九宫格中，形成一个完整的奇门局。这个局象反映了特定时间与空间的能量分布状态，是进行预测分析的基础。'
        },
        {
          subtitle: '排盘的基本要素',
          text: '1. **时间要素**：年、月、日、时（四柱）\n2. **空间要素**：九宫格方位（后天八卦方位）\n3. **符号系统**：\n   • 天干：甲、乙、丙、丁、戊、己、庚、辛、壬、癸\n   • 地支：子、丑、寅、卯、辰、巳、午、未、申、酉、戌、亥\n   • 九星：天蓬、天任、天冲、天辅、天英、天芮、天柱、天心、天禽\n   • 八门：开、休、生、伤、杜、景、死、惊\n   • 八神：值符、螣蛇、太阴、六合、白虎、玄武、九地、九天\n4. **规律体系**：\n   • 阴阳二遁规律\n   • 九宫排列规律\n   • 天干地支配伍规律'
        },
        {
          subtitle: '排盘的基本原则',
          text: '1. **时空统一原则**：时间和空间在奇门局中是统一的整体\n2. **阴阳协调原则**：阴遁和阳遁的选择要根据节气确定\n3. **循环往复原则**：所有符号按照固定规律循环排列\n4. **生克制化原则**：各符号间通过五行生克关系相互作用\n5. **动静结合原则**：静态排列与动态变化相结合'
        },
        {
          subtitle: '排盘的学习路径',
          text: '1. **基础阶段**：掌握天干地支、阴阳五行基础理论\n2. **符号阶段**：熟记九星、八门、八神的名称和属性\n3. **规律阶段**：理解各种排列组合的内在规律\n4. **实践阶段**：通过大量排盘练习掌握操作技能\n5. **应用阶段**：学会分析局象进行实际预测\n\n排盘是奇门遁甲的"技术"层面，需要通过系统学习和大量练习才能真正掌握。'
        }
      ]
    },
    'time-setup': {
      title: '时间起局 - 时空坐标的确定',
      content: [
        {
          subtitle: '农历与公历转换',
          text: '奇门遁甲排盘使用农历时间，因此需要将公历时间转换为农历：\n\n1. **年柱确定**：\n   • 以农历立春为年的分界点\n   • 立春前为上年，立春后为当年\n   • 六十年一甲子循环\n\n2. **月柱确定**：\n   • 以农历节气为月的分界点\n   • 一年十二个月对应十二地支\n   • 寅月从立春开始，丑月到立春结束\n\n3. **日柱确定**：\n   • 以子时（23:00-次日1:00）为日分界\n   • 六十日一甲子循环\n   • 从公元前2697年的甲子年开始计算\n\n4. **时柱确定**：\n   • 一日十二个时辰，每个时辰2小时\n   • 子时：23:00-01:00，丑时：01:00-03:00\n   • 寅时：03:00-05:00，卯时：05:00-07:00\n   • 辰时：07:00-09:00，巳时：09:00-11:00\n   • 午时：11:00-13:00，未时：13:00-15:00\n   • 申时：15:00-17:00，酉时：17:00-19:00\n   • 戌时：19:00-21:00，亥时：21:00-23:00'
        },
        {
          subtitle: '时辰的干支确定',
          text: '时辰天干根据日干和五鼠遁确定：\n\n**五鼠遁口诀**：\n甲己还加甲，乙庚丙作初\n丙辛从戊起，丁壬庚子居\n戊癸何方发，壬子是真途\n\n**具体对应关系**：\n• 甲日、己日：甲子时起\n• 乙日、庚日：丙子时起\n• 丙日、辛日：戊子时起\n• 丁日、壬日：庚子时起\n• 戊日、癸日：壬子时起\n\n**应用举例**：\n若日干为甲，则子时为甲子，丑时为乙丑，寅时为丙寅，以此类推。'
        },
        {
          subtitle: '节气与时间确定',
          text: '奇门遁甲特别重视节气，因为节气决定了阴阳二遁的转换：\n\n**二十四节气**：\n• 春季：立春、雨水、惊蛰、春分、清明、谷雨\n• 夏季：立夏、小满、芒种、夏至、小暑、大暑\n• 秋季：立秋、处暑、白露、秋分、寒露、霜降\n• 冬季：立冬、小雪、大雪、冬至、小寒、大寒\n\n**关键节气**：\n• 冬至：一阳初生，开始阳遁\n• 夏至：一阴初生，开始阴遁\n\n**节气时间查找**：\n1. 使用万年历查找具体节气的准确时间\n2. 节气以交节时刻为准，不是以日期为准\n3. 同一节气在不同年份的交节时间不同'
        },
        {
          subtitle: '时辰的精确计算',
          text: '现代奇门遁甲排盘需要注意时辰的精确性：\n\n1. **地方时与标准时**：\n   • 奇门遁甲使用地方真太阳时\n   • 需要根据经度差异进行时间校正\n   • 经度每差15度，时间差1小时\n\n2. **时辰校正方法**：\n   • 东经120度为标准时间基准\n   • 地方时 = 标准时 ± 经度差 × 4分钟/度\n   • 东经120°以东：地方时 = 标准时 + 经度差 × 4分钟\n   • 东经120°以西：地方时 = 标准时 - 经度差 × 4分钟\n\n3. **时辰边界的处理**：\n   • 正好在时辰边界的时间要特别谨慎\n   • 建议确认具体出生或事件时间\n   • 无法确定时可分析相邻时辰的两个局'
        }
      ]
    },
    'yin-yang': {
      title: '阴阳遁局 - 节气转换的规律',
      content: [
        {
          subtitle: '阴阳二遁的概念',
          text: '阴阳二遁是奇门遁甲排盘的核心规律，体现了宇宙阴阳消长的自然规律：\n\n**阳遁**：\n• 时间：冬至到夏至期间\n• 特点：阳气渐长，万物生发\n• 规律：顺排（九星、八门顺时针排列）\n• 局数：阳遁一局至阳遁九局\n\n**阴遁**：\n• 时间：夏至到冬至期间\n• 特点：阴气渐长，万物收藏\n• 规律：逆排（九星、八门逆时针排列）\n• 局数：阴遁一局至阴遁九局\n\n阴阳二遁的转换体现了自然界阴阳消长的规律，是奇门遁甲预测准确性的重要保证。'
        },
        {
          subtitle: '阴阳遁的确定方法',
          text: '1. **节气确定法**：\n   • 冬至到夏至：使用阳遁\n   • 夏至到冬至：使用阴遁\n   • 以具体交节时间为准\n\n2. **时间判断法**：\n   • 查询当前时间在哪个节气范围内\n   • 确定是阳遁期还是阴遁期\n   • 使用对应的排盘规律\n\n3. **节气查询步骤**：\n   1) 确定预测日期\n   2) 查询该日期所在的节气\n   3) 判断距离冬至或夏至的时间\n   4) 确定使用阳遁还是阴遁\n\n**注意**：节气交节的准确时间很重要，必须以天文历法为准。'
        },
        {
          subtitle: '阳遁九局的排布规律',
          text: '阳遁九局按照以下规律排列：\n\n**阳遁一局**：甲子戊在坎一宫\n**阳遁二局**：甲子戊在坤二宫\n**阳遁三局**：甲子戊在震三宫\n**阳遁四局**：甲子戊在巽四宫\n**阳遁五局**：甲子戊在中五宫\n**阳遁六局**：甲子戊在乾六宫\n**阳遁七局**：甲子戊在兑七宫\n**阳遁八局**：甲子戊在艮八宫\n**阳遁九局**：甲子戊在离九宫\n\n**阳遁排列特点**：\n• 九星：顺时针排列（天蓬→天芮→天冲→天辅→天禽→天心→天柱→天任→天英）\n• 八门：顺时针排列（休→死→伤→杜→中→开→惊→生→景）\n• 天干：顺时针排列（戊→己→庚→辛→壬→癸→丁→丙→乙）'
        },
        {
          subtitle: '阴遁九局的排布规律',
          text: '阴遁九局按照以下规律排列：\n\n**阴遁一局**：甲子戊在坎一宫\n**阴遁二局**：甲子戊在坤二宫\n**阴遁三局**：甲子戊在震三宫\n**阴遁四局**：甲子戊在巽四宫\n**阴遁五局**：甲子戊在中五宫\n**阴遁六局**：甲子戊在乾六宫\n**阴遁七局**：甲子戊在兑七宫\n**阴遁八局**：甲子戊在艮八宫\n**阴遁九局**：甲子戊在离九宫\n\n**阴遁排列特点**：\n• 九星：逆时针排列（天蓬→天英→天任→天柱→天心→天禽→天辅→天冲→天芮）\n• 八门：逆时针排列（休→景→生→惊→开→中→杜→伤→死）\n• 天干：逆时针排列（戊→乙→丙→丁→癸→壬→辛→庚→己）\n\n阴阳遁的选择直接影响整个奇门局的结构和解读，是排盘的关键环节。'
        }
      ]
    },
    'palace-arrangement': {
      title: '九宫排布 - 符号系统的组合',
      content: [
        {
          subtitle: '九星排布规律',
          text: '九星是奇门遁甲中的重要符号，代表天体运行的影响：\n\n**九星名称与属性**：\n• 天蓬星：属水，主聪明、智慧\n• 天任星：属土，主诚信、稳重\n• 天冲星：属木，主决断、威严\n• 天辅星：属木，主文化、教育\n• 天英星：属火，主文明、光明\n• 天芮星：属土，主疾病、阻碍\n• 天柱星：属金，主破坏、冲击\n• 天心星：属金，主医术、领导\n• 天禽星：属土，主稳定、中心\n\n**阳遁九星排列**：\n坎一：天蓬星，坤二：天芮星，震三：天冲星\n巽四：天辅星，中五：天禽星，乾六：天心星\n兑七：天柱星，艮八：天任星，离九：天英星\n\n**阴遁九星排列**：\n坎一：天蓬星，坤二：天英星，震三：天任星\n巽四：天柱星，中五：天禽星，乾六：天心星\n兑七：天辅星，艮八：天冲星，离九：天芮星'
        },
        {
          subtitle: '八门排布规律',
          text: '八门代表人事活动的吉凶状态：\n\n**八门分类**：\n**吉门**：开、休、生三门\n**凶门**：死、惊、伤三门\n**平门**：杜、景二门\n\n**八门详细属性**：\n• 开门：大吉，主开启、开创、事业成功\n• 休门：大吉，主休息、平安、家庭和谐\n• 生门：大吉，主生长、财富、身体健康\n• 伤门：凶，主伤害、疾病、官非\n• 杜门：平，主阻碍、保密、技术\n• 景门：平，主光明、文书、血光\n• 死门：大凶，主死亡、牢狱、疾病\n• 惊门：凶，主惊恐、官司、意外\n\n**阳遁八门排列**：\n坎一：休门，坤二：死门，震三：伤门\n巽四：杜门，中五：无门，乾六：开门\n兑七：惊门，艮八：生门，离九：景门\n\n**阴遁八门排列**：\n坎一：休门，坤二：景门，震三：生门\n巽四：惊门，中五：无门，乾六：开门\n兑七：杜门，艮八：伤门，离九：死门'
        },
        {
          subtitle: '八神排布规律',
          text: '八神代表神灵超自然力量的影响：\n\n**八神名称与属性**：\n• 值符：百神之首，大吉，主贵人、权威\n• 螣蛇：主变化、虚假、惊恐\n• 太阴：主女人、金钱、隐蔽\n• 六合：主婚姻、合作、和谐\n• 白虎：主凶恶、武力、血光\n• 玄武：主偷盗、欺骗、暧昧\n• 九地：主稳定、坤土、长久\n• 九天：主高远、飞行、升迁\n\n**八神排列规律**：\n八神按照值符→螣蛇→太阴→六合→白虎→玄武→九地→九天的顺序，从值符所在宫开始顺时针排列。'
        },
        {
          subtitle: '三奇六仪排布',
          text: '三奇六仪是奇门遁甲的核心符号系统：\n\n**三奇**：\n• 乙奇：日奇，属木，主文书、医生\n• 丙奇：月奇，属火，主权威、官员\n• 丁奇：星奇，属火，主文书、美女\n\n**六仪**：\n• 戊仪：阳土，甲子戊\n• 己仪：阴土，甲戌己\n• 庚仪：阳金，甲申庚\n• 辛仪：阴金，甲午辛\n• 壬仪：阳水，甲辰壬\n• 癸仪：阴水，甲寅癸\n\n**排布原则**：\n1. 甲子戊为首，统领其他仪奇\n2. 阳遁顺排，阴遁逆排\n3. 与九星八门配合形成完整格局\n4. 三奇为吉，六仪为凶\n\n三奇六仪的排布直接关系到奇门局的吉凶判断，是排盘中的重要环节。'
        }
      ]
    },
    'complete-process': {
      title: '完整流程 - 从时间到成局',
      content: [
        {
          subtitle: '排盘完整步骤概述',
          text: '奇门遁甲排盘是一个系统性过程，包含以下主要步骤：\n\n1. **时间确定**：将公历时间转换为农历干支时间\n2. **局数确定**：根据时辰和旬首确定使用几局\n3. **阴阳遁判断**：根据节气确定阳遁或阴遁\n4. **天盘排布**：排布天干、九星、八门\n5. **地盘排布**：排布地支和六仪\n6. **神盘排布**：排布八神系统\n7. **格局分析**：分析成局的吉凶状态\n\n每个步骤都需要精确计算和准确理解，任何一个环节的误差都会影响最终的预测结果。'
        },
        {
          subtitle: '第一步：时间要素的确定',
          text: '**操作流程**：\n\n1. **获取预测时间**：\n   • 确定年月日时（使用真太阳时）\n   • 记录准确到分钟的时间\n   • 确定地点的经纬度\n\n2. **公历转农历**：\n   • 查找对应农历日期\n   • 确定年月日的干支\n   • 注意节气交节时间\n\n3. **时辰干支确定**：\n   • 确定时辰地支\n   • 用五鼠遁确定时辰天干\n   • 形成完整的时辰干支\n\n**举例说明**：\n2024年3月15日下午14:30北京\n• 公历时间：2024年3月15日14:30\n• 农历时间：甲辰年二月初六\n• 时辰：未时（13:00-15:00）\n• 时辰干支：辛未时'
        },
        {
          subtitle: '第二步：局数与阴阳遁确定',
          text: '**局数确定方法**：\n\n1. **旬首确定**：\n   • 根据日干支确定旬首\n   • 六十甲子分为六旬：甲子旬、甲戌旬、甲申旬、甲午旬、甲辰旬、甲寅旬\n   • 每旬包含10个干支组合\n\n2. **时辰对应局数**：\n   • 查找时辰在甲子、甲戌、甲申等哪个旬中\n   • 确定对应的局数（1-9局）\n   • 结合阴阳遁确定具体用哪一局\n\n3. **阴阳遁判断**：\n   • 确定当前节气\n   • 判断在冬至-夏至还是夏至-冬至期间\n   • 确定使用阳遁还是阴遁\n\n**实际操作**：\n使用奇门遁甲排盘盘表或软件快速确定局数，避免手工计算的复杂性。'
        },
        {
          subtitle: '第三步：天盘地盘的排布',
          text: '**天盘排布步骤**：\n\n1. **九星排布**：\n   • 根据阴阳遁确定顺排或逆排\n   • 从值符星开始，按规律排列其他八星\n   • 确定每个星的落宫位置\n\n2. **八门排布**：\n   • 根据阴阳遁确定顺排或逆排\n   • 从值符门开始，按规律排列其他七门\n   • 确定每个门的落宫位置\n\n3. **天干排布**：\n   • 排布三奇六仪到九宫\n   • 确定甲子戊的位置\n   • 按顺序排布其他仪奇\n\n**地盘排布步骤**：\n1. **固定地盘**：后天八卦方位固定不变\n2. **六仪定位**：六仪在地盘的位置固定\n3. **对应关系**：建立天盘地盘的对应关系\n\n**神盘排布**：\n• 从值符宫开始排布八神\n• 按照固定顺序顺时针排列\n• 确定每个神的落宫位置'
        },
        {
          subtitle: '第四步：格局分析与检验',
          text: '**格局检验要点**：\n\n1. **值符值使**：\n   • 确定值符星和值使门\n   • 分析其落宫位置和状态\n   • 这是分析局象的关键\n\n2. **飞宫检查**：\n   • 检查是否有飞宫（伏吟、反吟）\n   • 分析飞宫的影响和意义\n   • 判断格局的吉凶属性\n\n3. **特殊格局识别**：\n   • 识别三奇得使、三奇游六仪等吉格\n   • 识别飞宫、伏吟、反吟等凶格\n   • 分析格局的整体趋势\n\n4. **用神确定**：\n   • 根据预测事项确定用神\n   • 分析用神的落宫和状态\n   • 结合整体格局进行判断\n\n**排盘完成标志**：\n• 所有符号排布完毕\n• 格局分析完成\n• 可以开始具体的预测分析\n\n排盘是技术性很强的工作，需要大量练习才能熟练掌握。建议初学者使用专业软件辅助学习，在掌握基本原理后再逐步过渡到手工排盘。'
        }
      ]
    }
  };

  const currentContent = content[selectedSection];

  return (
    <div className="max-w-4xl mx-auto">
      <div className="bg-white rounded-xl shadow-lg p-8 mb-8">
        <h2 className="text-2xl font-bold text-gray-800 mb-6">{currentContent.title}</h2>

        {/* 导航标签 */}
        <div className="flex flex-wrap gap-2 mb-8 border-b">
          {sections.map((section) => (
            <button
              key={section.id}
              onClick={() => setSelectedSection(section.id)}
              className={`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-colors ${
                selectedSection === section.id
                  ? 'bg-amber-600 text-white'
                  : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
              }`}
            >
              <span className="text-xl">{section.icon}</span>
              <span>{section.title}</span>
            </button>
          ))}
        </div>

        {/* 内容区域 */}
        <div className="space-y-6">
          {currentContent.content.map((item, index) => (
            <div key={index} className="bg-gray-50 p-6 rounded-lg">
              {item.subtitle && (
                <h3 className="text-lg font-bold text-amber-700 mb-3">{item.subtitle}</h3>
              )}
              <div className="text-gray-700 leading-relaxed whitespace-pre-line">
                {item.text}
              </div>
            </div>
          ))}
        </div>

        {/* 相关提示 */}
        <div className="bg-amber-50 p-6 rounded-lg border border-amber-200">
          <h3 className="text-lg font-bold text-amber-800 mb-3">排盘要点</h3>
          <ul className="space-y-2 text-sm text-gray-700">
            <li>• 排盘需要准确的时间（真太阳时）和地点信息</li>
            <li>• 节气的准确判断是阴阳遁选择的关键</li>
            <li>• 建议使用专业软件辅助学习，避免计算错误</li>
            <li>• 大量练习是掌握排盘技术的必经之路</li>
          </ul>
        </div>
      </div>

      {/* 相关资源 */}
      <div className="bg-white rounded-xl shadow-lg p-8">
        <h3 className="text-xl font-bold text-gray-800 mb-6">相关学习资源</h3>
        <div className="grid md:grid-cols-3 gap-6">
          <a href="/knowledge/basic-theory" className="p-4 bg-gray-50 rounded-lg hover:bg-amber-50 transition-colors">
            <h4 className="font-semibold text-gray-800 mb-2">基础理论</h4>
            <p className="text-sm text-gray-600">复习排盘相关的理论基础</p>
          </a>
          <a href="/chart" className="p-4 bg-gray-50 rounded-lg hover:bg-amber-50 transition-colors">
            <h4 className="font-semibold text-gray-800 mb-2">排盘工具</h4>
            <p className="text-sm text-gray-600">使用专业排盘工具进行练习</p>
          </a>
          <a href="/knowledge/interpretation" className="p-4 bg-gray-50 rounded-lg hover:bg-amber-50 transition-colors">
            <h4 className="font-semibold text-gray-800 mb-2">断局技巧</h4>
            <p className="text-sm text-gray-600">学习如何分析排好的奇门局</p>
          </a>
        </div>
      </div>
    </div>
  );
}